%% -*- coding: utf-8; IspellDict: francais -*- 

\def\fileversion{1.0}
\def\filedate{2023/01/10}
\def\basename{ths}
\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{\basename}
              [\filedate\space v\fileversion\space for ths]
\typeout{Style `\basename', Version \fileversion\space <\filedate>}
\typeout{A utiliser avec la classe report}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% De la typo de la thèse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% pour les titres de sections, de sous-sections, etc.
\renewcommand\section{\@startsection {section}{1}{\z@}%
                                   {-3.5ex \@plus -1ex \@minus -.2ex}%
                                   {2.3ex \@plus.2ex}%
                                   {\sffamily\Large\bfseries}}
\renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\sffamily\large\bfseries}}
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\sffamily\normalsize\bfseries}}
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
                                    {3.25ex \@plus1ex \@minus.2ex}%
                                    {-1em}%
                                    {\sffamily\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{5}{\parindent}%
                                       {3.25ex \@plus1ex \@minus .2ex}%
                                       {-1em}%
                                      {\normalfont\normalsize\bfseries}}

% titre associé à la bibliographie
\renewcommand{\bibname}{Références}

% là ,je renumérote les sections hors chapitres. Mais je ne peux m'en servir
% ss modifs ds la mesure où cela plante...

\renewcommand{\thesection}{\@arabic\c@section}
%\setcounter{tocdepth}{4}
%\setcounter{secnumdepth}{4}

% mise en forme de la biblio
\renewenvironment{thebibliography}[1]
{\chapter*{\bibname
    \@mkboth{\bibname}{\bibname}}%
  \addcontentsline{toc}{chapter}{Références}
  \list{\@biblabel{\@arabic\c@enumiv}}%
  {\settowidth\labelwidth{\@biblabel{#1}}%
    \leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \@openbib@code
    \usecounter{enumiv}%
    \let\p@enumiv\@empty
    \renewcommand\theenumiv{\@arabic\c@enumiv}}%
  \sloppy
  \clubpenalty4000
  \@clubpenalty \clubpenalty
  \widowpenalty4000%
  \sfcode`\.\@m}
{\def\@noitemerr
  {\@latex@warning{Empty `thebibliography' environment}}
  \endlist}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% De la mise en page générale de la thèse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% pour les remerciements, les résumés.
\newcommand{\mysection}[1]{
\markboth{#1}{#1}
\addcontentsline{toc}{chapter}{#1}}

% Pour la preface, le contenu de la these ... et tout chapitre non numerote 
% a markboth symetrique rentrant dans les tables des matieres
\newcommand{\mychapter}[1]{
\chapter*{#1}
\markboth{#1}{#1}
\addcontentsline{toc}{chapter}{#1}
%\addcontentsline{roc}{chapter}{#1}
}

%pour qu'l n'y ait pas de headings sur une page de fin de chapitre paire
\newcommand{\finishedchapter}{
\clearpage
\markboth{}{}
\thispagestyle{empty}
\cleardoublepage
}

%pour qu'l n'y ait pas de headings sur une page de fin d'annexe paire
\newcommand{\finishedannex}{
\clearpage
}

% Pour les introductions de chapitres
\newenvironment{introchapter}{%
\begin{quote}
\em}
{\end{quote}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Commandes de travail
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Commande \adev{}
\newcommand{\adev}[1]{%
  \mbox{}\marginpar{\small\sffamily\raggedright
     {\scshape\color{blue}\hspace{0pt}À développer} : #1}}

% Commande \acorr{}
\newcommand{\acorr}[1]{%
  \mbox{}\marginpar{\small\sffamily\raggedright
    {\scshape\color{red}\hspace{0pt}À corriger} : #1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% En-têtes et pieds de page
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{fancy}

\addtolength{\headwidth}{0.4\marginparwidth}
\renewcommand{\chaptermark}[1]{%
  \markboth{\chaptername\ \thechapter\ -- %
      \ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ -- #1}}
\fancyhf{}
\fancyhead[LE,RO]{\sffamily\thepage}
\fancyhead[LO]{\sffamily\nouppercase{\rightmark}}
\fancyhead[RE]{\sffamily\nouppercase{\leftmark}}
\fancypagestyle{plain}{% car aux 1res de chapitre, il repasse en plain... donc
                       % pour le vider
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  }

\renewcommand\topfraction{0.95}
\renewcommand\bottomfraction{0.95}
